<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è –≤ –ß–µ—Ö–∏–∏ | √öƒçetnictv√≠ v ƒåR</title>
  <style>
    :root {
      --primary: #2a9d8f;
      --secondary: #264653;
      --light: #e9f5f3;
      --dark: #1d3557;
      --gray: #8d99ae;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: system-ui, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    header {
      background: var(--secondary);
      color: white;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .logo { font-size: 1.4rem; font-weight: bold; }
    .lang-switch { display: flex; gap: 0.5rem; }
    .lang-btn {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 4px;
      cursor: pointer;
    }
    .lang-btn.active {
      background: white;
      color: var(--secondary);
    }
    .access-info {
      background: rgba(255,255,255,0.15);
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-size: 0.9rem;
    }
    .container {
      max-width: 800px;
      margin: 2rem auto;
      padding: 0 1.5rem;
    }
    .auth-block {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    .form-group { margin: 1rem 0; }
    label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
    input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
    }
    button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
    }
    .status { margin-top: 0.5rem; font-size: 0.9rem; }
    .status.success { color: var(--primary); }
    .status.error { color: #e76f51; }
    .switch-form { margin-top: 1rem; color: var(--gray); }
    .switch-form a {
      color: var(--primary);
      text-decoration: none;
      cursor: pointer;
    }
    [data-lang="cz"] { display: none; }
    html[cz] [data-lang="ru"] { display: none !important; }
    html[cz] [data-lang="cz"] { display: block !important; }
  </style>
</head>
<body>
  <header>
    <div class="logo" data-lang="ru">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è –≤ –ß–µ—Ö–∏–∏</div>
    <div class="logo" data-lang="cz">√öƒçetnictv√≠ v ƒåR</div>
    <div class="lang-switch">
      <button class="lang-btn active" data-set-lang="ru">üá∑üá∫ RU</button>
      <button class="lang-btn" data-set-lang="cz">üá®üáø CZ</button>
    </div>
    <div class="access-info" id="accessStatus">
      <span data-lang="ru">–ù–µ –≤ —Å–∏—Å—Ç–µ–º–µ</span>
      <span data-lang="cz">Nep≈ôihl√°≈°en</span>
    </div>
  </header>

  <div class="container">
    <div id="registerForm" class="auth-block">
      <h2 data-lang="ru">–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç</h2>
      <h2 data-lang="cz">Vytvo≈ôte √∫ƒçet</h2>
      <div class="form-group">
        <label for="email" data-lang="ru">Email</label>
        <label for="email" data-lang="cz">E-mail</label>
        <input type="email" id="email" required>
      </div>
      <div class="form-group">
        <label for="password" data-lang="ru">–ü–∞—Ä–æ–ª—å (–æ—Ç 6 —Å–∏–º–≤–æ–ª–æ–≤)</label>
        <label for="password" data-lang="cz">Heslo (od 6 znak≈Ø)</label>
        <input type="password" id="password" minlength="6" required>
      </div>
      <button id="registerBtn" data-lang="ru">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
      <button id="registerBtn" data-lang="cz">Registrovat</button>
      <div class="switch-form">
        <a id="showLogin" data-lang="ru">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏</a>
        <a id="showLogin" data-lang="cz">Ji≈æ m√°te √∫ƒçet? P≈ôihl√°sit se</a>
      </div>
      <div id="regStatus" class="status"></div>
    </div>

    <div id="loginForm" class="auth-block" style="display:none;">
      <h2 data-lang="ru">–í—Ö–æ–¥</h2>
      <h2 data-lang="cz">P≈ôihl√°≈°en√≠</h2>
      <div class="form-group">
        <label for="loginEmail" data-lang="ru">Email</label>
        <label for="loginEmail" data-lang="cz">E-mail</label>
        <input type="email" id="loginEmail" required>
      </div>
      <div class="form-group">
        <label for="loginPassword" data-lang="ru">–ü–∞—Ä–æ–ª—å</label>
        <label for="loginPassword" data-lang="cz">Heslo</label>
        <input type="password" id="loginPassword" required>
      </div>
      <button id="loginBtn" data-lang="ru">–í–æ–π—Ç–∏</button>
      <button id="loginBtn" data-lang="cz">P≈ôihl√°sit se</button>
      <div class="switch-form">
        <a id="showRegister" data-lang="ru">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
        <a id="showRegister" data-lang="cz">Nem√°te √∫ƒçet? Registrovat</a>
      </div>
      <div id="loginStatus" class="status"></div>
    </div>

    <div id="activateForm" class="auth-block" style="display:none;">
      <h2 data-lang="ru">–ê–∫—Ç–∏–≤–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–∞</h2>
      <h2 data-lang="cz">Aktivace p≈ô√≠stupu</h2>
      <div class="form-group">
        <label for="code" data-lang="ru">–ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞</label>
        <label for="code" data-lang="cz">P≈ô√≠stupov√Ω k√≥d</label>
        <input type="text" id="code" required>
      </div>
      <button id="activateBtn" data-lang="ru">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
      <button id="activateBtn" data-lang="cz">Aktivovat</button>
      <div class="switch-form">
        <a id="backToLoginLink" data-lang="ru">‚Üê –ù–∞–∑–∞–¥</a>
        <a id="backToLoginLink" data-lang="cz">‚Üê Zpƒõt</a>
      </div>
      <div id="activateStatus" class="status"></div>
    </div>

    <div id="content" class="auth-block" style="display:none;">
      <h2 data-lang="ru">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –î–æ—Å—Ç—É–ø –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω.</h2>
      <h2 data-lang="cz">V√≠tejte! P≈ô√≠stup je aktivov√°n.</h2>
      <p data-lang="ru">–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–º–æ—Ç—Ä–µ—Ç—å —É—Ä–æ–∫–∏ –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ç–µ—Å—Ç—ã.</p>
      <p data-lang="cz">Nyn√≠ m≈Ø≈æete sledovat lekce a absolvovat testy.</p>
    </div>
  </div>

  <script>
    // –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
    document.querySelectorAll('[data-set-lang]').forEach(btn => {
      btn.addEventListener('click', () => {
        const lang = btn.dataset.setLang;
        document.documentElement.setAttribute('lang', lang);
        if (lang === 'cz') document.documentElement.setAttribute('cz', '');
        else document.documentElement.removeAttribute('cz');
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });
    });

    // API-–≤—ã–∑–æ–≤—ã
    async function apiCall(endpoint, data) {
      const res = await fetch(`/api${endpoint}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      return res.json();
    }

    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
    document.getElementById('registerBtn').addEventListener('click', async () => {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const status = document.getElementById('regStatus');
      
      try {
        const data = await apiCall('/register', { email, password });
        status.className = 'status success';
        status.textContent = '‚úÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! / ‚úÖ √öƒçet vytvo≈ôen!';
        setTimeout(() => {
          document.getElementById('registerForm').style.display = 'none';
          document.getElementById('loginForm').style.display = 'block';
        }, 1000);
      } catch (err) {
        status.className = 'status error';
        status.textContent = `‚ùå ${err.message || '–û—à–∏–±–∫–∞'}`;
      }
    });

    // –í—Ö–æ–¥
    document.getElementById('loginBtn').addEventListener('click', async () => {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      const status = document.getElementById('loginStatus');
      
      try {
        const data = await apiCall('/login', { email, password });
        if (data.hasAccess) {
          document.getElementById('content').style.display = 'block';
          document.getElementById('loginForm').style.display = 'none';
        } else {
          document.getElementById('loginForm').style.display = 'none';
          document.getElementById('activateForm').style.display = 'block';
        }
        status.className = 'status success';
        status.textContent = '‚úÖ –í—Ö–æ–¥ —É—Å–ø–µ—à–µ–Ω / ‚úÖ √öspƒõ≈°n√© p≈ôihl√°≈°en√≠';
      } catch (err) {
        status.className = 'status error';
        status.textContent = `‚ùå ${err.message || '–ù–µ–≤–µ—Ä–Ω—ã–π email/–ø–∞—Ä–æ–ª—å'}`;
      }
    });

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è
    document.getElementById('activateBtn').addEventListener('click', async () => {
      const email = document.getElementById('loginEmail').value;
      const code = document.getElementById('code').value;
      const status = document.getElementById('activateStatus');
      
      try {
        const data = await apiCall('/activate', { email, code });
        document.getElementById('activateForm').style.display = 'none';
        document.getElementById('content').style.display = 'block';
        status.className = 'status success';
        status.textContent = '‚úÖ –î–æ—Å—Ç—É–ø –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! / ‚úÖ P≈ô√≠stup aktivov√°n!';
      } catch (err) {
        status.className = 'status error';
        status.textContent = `‚ùå ${err.message || '–ö–æ–¥ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω'}`;
      }
    });

    // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏
    document.getElementById('showLogin').onclick = () => {
      document.getElementById('registerForm').style.display = 'none';
      document.getElementById('loginForm').style.display = 'block';
    };
    document.getElementById('showRegister').onclick = () => {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('registerForm').style.display = 'block';
    };
    document.getElementById('backToLoginLink').onclick = () => {
      document.getElementById('activateForm').style.display = 'none';
      document.getElementById('loginForm').style.display = 'block';
    };
  </script>
</body>
</html>